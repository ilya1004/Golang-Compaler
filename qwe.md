–û–ø–∏—Å–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü –∏ —Å—Ç–µ–∫–æ–≤

–í —ç—Ç–æ–º –∫–æ–¥–µ —Ä–µ–∞–ª–∏–∑—É–µ—Ç—Å—è —Å—Ç–µ–∫–æ–≤—ã–π –ø–∞—Ä—Å–µ—Ä –ø–æ —Å—Ö–µ–º–µ LR(1), –∏—Å–ø–æ–ª—å–∑—É—è —Ç–∞–±–ª–∏—Ü—ã –¥–µ–π—Å—Ç–≤–∏–π (action_table), –ø–µ—Ä–µ—Ö–æ–¥–æ–≤ (goto_table) –∏ –ø—Ä–∞–≤–∏–ª (rules).
1. –°—Ç–µ–∫ —Å–æ—Å—Ç–æ—è–Ω–∏–π (@state_stack)

–ß—Ç–æ —ç—Ç–æ?
–°—Ç–µ–∫, –≤ –∫–æ—Ç–æ—Ä–æ–º —Ö—Ä–∞–Ω—è—Ç—Å—è —Å–æ—Å—Ç–æ—è–Ω–∏—è –∞–≤—Ç–æ–º–∞—Ç–∞. –û–Ω –Ω–∞—á–∏–Ω–∞–µ—Ç —Å 0 (–Ω–∞—á–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ) –∏ –∏–∑–º–µ–Ω—è–µ—Ç—Å—è –≤–æ –≤—Ä–µ–º—è –ø–∞—Ä—Å–∏–Ω–≥–∞.

–ü—Ä–∏–º–µ—Ä —Ä–∞–±–æ—Ç—ã:
–ï—Å–ª–∏ –º—ã –≤—Å—Ç—Ä–µ—á–∞–µ–º —Ç–æ–∫–µ–Ω 'id' –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ 0, —Ç–æ —Å–æ–≤–µ—Ä—à–∞–µ–º shift –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–µ 2, —Ç–æ –µ—Å—Ç—å —Å—Ç–µ–∫ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è [0, 2].
2. –°—Ç–µ–∫ –∑–Ω–∞—á–µ–Ω–∏–π (@value_stack)

–ß—Ç–æ —ç—Ç–æ?
–°—Ç–µ–∫, –≤ –∫–æ—Ç–æ—Ä–æ–º —Ö—Ä–∞–Ω—è—Ç—Å—è –∑–Ω–∞—á–µ–Ω–∏—è —É–∑–ª–æ–≤ (AST) –∏–ª–∏ —Ç–æ–∫–µ–Ω—ã. –ü—Ä–∏ shift —Ç—É–¥–∞ –∫–ª–∞–¥–µ—Ç—Å—è —Ç–æ–∫–µ–Ω, –ø—Ä–∏ reduce ‚Äî —É–∑–µ–ª AST.

–ü—Ä–∏–º–µ—Ä —Ä–∞–±–æ—Ç—ã:

    –ü—Ä–∏ shift, –≤ —Å—Ç–µ–∫ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è —Ç–æ–∫–µ–Ω (id –∏–ª–∏ l_paren).
    –ü—Ä–∏ reduce, –±–µ—Ä—É—Ç—Å—è –Ω–µ—Å–∫–æ–ª—å–∫–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤, –∑–∞–º–µ–Ω—è—é—Ç—Å—è –æ–¥–Ω–∏–º —É–∑–ª–æ–º (AST).

3. –¢–∞–±–ª–∏—Ü–∞ –¥–µ–π—Å—Ç–≤–∏–π (%action_table)

–≠—Ç–∞ —Ç–∞–±–ª–∏—Ü–∞ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç, —á—Ç–æ –¥–µ–ª–∞—Ç—å –ø—Ä–∏ –≤—Å—Ç—Ä–µ—á–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Ç–æ–∫–µ–Ω–∞ –≤ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏.
–§–æ—Ä–º–∞—Ç:

$action_table{state}{token} = [ action_type, value ];

    state ‚Äî —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∞.
    token ‚Äî —Ç–µ–∫—É—â–∏–π –≤—Ö–æ–¥–Ω–æ–π —Ç–æ–∫–µ–Ω.
    action_type ‚Äî —Ç–∏–ø –¥–µ–π—Å—Ç–≤–∏—è:
        'shift' ‚Äî –ø–µ—Ä–µ–π—Ç–∏ –≤ –Ω–æ–≤–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ (value —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–æ–º–µ—Ä —Å–æ—Å—Ç–æ—è–Ω–∏—è).
        'reduce' ‚Äî —Å–≤–µ—Ä–Ω—É—Ç—å —Ü–µ–ø–æ—á–∫—É (value —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–æ–º–µ—Ä –ø—Ä–∞–≤–∏–ª–∞ –≤ rules).
        'accept' ‚Äî –∑–∞–≤–µ—Ä—à–∏—Ç—å –ø–∞—Ä—Å–∏–Ω–≥.

–ü—Ä–∏–º–µ—Ä—ã —Ä–∞–±–æ—Ç—ã:

$action_table{0}{'id'} = [ 'shift', 2 ];

‚Üí –ï—Å–ª–∏ –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ 0 –≤–∏–¥–∏–º id, –ø–µ—Ä–µ—Ö–æ–¥–∏–º –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–µ 2 (shift 2).

$action_table{2}{'EOF'} = [ 'reduce', 1 ];

‚Üí –ï—Å–ª–∏ –≤ 2 –≤–∏–¥–∏–º EOF, —Å–≤–æ—Ä–∞—á–∏–≤–∞–µ–º –ø–æ –ø—Ä–∞–≤–∏–ª—É 1.
4. –¢–∞–±–ª–∏—Ü–∞ –ø–µ—Ä–µ—Ö–æ–¥–æ–≤ (%goto_table)

–≠—Ç–∞ —Ç–∞–±–ª–∏—Ü–∞ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç, –≤ –∫–∞–∫–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç—å –ø–æ—Å–ª–µ reduce, –µ—Å–ª–∏ –±—ã–ª –ø–æ–ª—É—á–µ–Ω –Ω–µ—Ç–µ—Ä–º–∏–Ω–∞–ª.
–§–æ—Ä–º–∞—Ç:

$goto_table{state}{nonterminal} = new_state;

    state ‚Äî —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∞.
    nonterminal ‚Äî –Ω–µ—Ç–µ—Ä–º–∏–Ω–∞–ª, –ø–æ–ª—É—á–µ–Ω–Ω—ã–π –ø–æ—Å–ª–µ reduce.
    new_state ‚Äî —Å–æ—Å—Ç–æ—è–Ω–∏–µ, –≤ –∫–æ—Ç–æ—Ä–æ–µ –Ω—É–∂–Ω–æ –ø–µ—Ä–µ–π—Ç–∏.

–ü—Ä–∏–º–µ—Ä—ã —Ä–∞–±–æ—Ç—ã:

$goto_table{0}{'EXPR'} = 1;

‚Üí –ï—Å–ª–∏ –≤ 0 –ø–æ—Å–ª–µ reduce –ø–æ–ª—É—á–∏–ª–∏ EXPR, –ø–µ—Ä–µ—Ö–æ–¥–∏–º –≤ 1.
5. –¢–∞–±–ª–∏—Ü–∞ –ø—Ä–∞–≤–∏–ª (%rules)

–≠—Ç–∞ —Ç–∞–±–ª–∏—Ü–∞ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –ø—Ä–∞–≤–∏–ª–∞ —Å–≤–µ—Ä—Ç–∫–∏ (reduce), —Ç–æ –µ—Å—Ç—å –∫–∞–∫–∏–µ —Ç–æ–∫–µ–Ω—ã –∑–∞–º–µ–Ω—è—Ç—å –Ω–∞ –Ω–µ—Ç–µ—Ä–º–∏–Ω–∞–ª—ã.
–§–æ—Ä–º–∞—Ç:

$rules{rule_id} = [ lhs, rhs_count ];

    rule_id ‚Äî –Ω–æ–º–µ—Ä –ø—Ä–∞–≤–∏–ª–∞.
    lhs ‚Äî –Ω–µ—Ç–µ—Ä–º–∏–Ω–∞–ª, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–ª—É—á–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ —Å–≤–µ—Ä—Ç–∫–∏.
    rhs_count ‚Äî —Å–∫–æ–ª—å–∫–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ —É–±—Ä–∞—Ç—å –∏–∑ value_stack.

–ü—Ä–∏–º–µ—Ä—ã —Ä–∞–±–æ—Ç—ã:

$rules{1} = [ 'EXPR', 1 ];

‚Üí –ü—Ä–∞–≤–∏–ª–æ 1: –æ–¥–∏–Ω —ç–ª–µ–º–µ–Ω—Ç (rhs_count = 1) –∑–∞–º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ EXPR.

$rules{2} = [ 'EXPR', 3 ];

‚Üí –ü—Ä–∞–≤–∏–ª–æ 2: —Ç—Ä–∏ —ç–ª–µ–º–µ–Ω—Ç–∞ (rhs_count = 3) –∑–∞–º–µ–Ω—è—é—Ç—Å—è –Ω–∞ EXPR.
–ü—Ä–∏–º–µ—Ä —Ä–∞–±–æ—Ç—ã –ø–∞—Ä—Å–µ—Ä–∞
–í—Ö–æ–¥–Ω–∞—è —Å—Ç—Ä–æ–∫–∞:

id + id EOF

–®–∞–≥–∏ —Ä–∞–±–æ—Ç—ã:
–®–∞–≥	–°—Ç–µ–∫ —Å–æ—Å—Ç–æ—è–Ω–∏–π	–°—Ç–µ–∫ –∑–Ω–∞—á–µ–Ω–∏–π	–¢–µ–∫—É—â–∏–π —Ç–æ–∫–µ–Ω	–î–µ–π—Å—Ç–≤–∏–µ
1	[0]	[]	id	shift 2
2	[0, 2]	[id]	+	shift 4
3	[0, 2, 4]	[id, +]	id	shift 2
4	[0, 2, 4, 2]	[id, +, id]	EOF	reduce 1 (–∑–∞–º–µ–Ω–∞ id –Ω–∞ EXPR)
5	[0, 2, 4]	[id, +, EXPR]	EOF	reduce 2 (–∑–∞–º–µ–Ω–∞ EXPR + EXPR –Ω–∞ EXPR)
6	[0, 2]	[EXPR]	EOF	reduce 1
7	[0]	[EXPR]	EOF	accept (–ø–∞—Ä—Å–∏–Ω–≥ –∑–∞–≤–µ—Ä—à–µ–Ω)
–í—ã–≤–æ–¥

    state_stack –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∞.
    value_stack —Å–æ–¥–µ—Ä–∂–∏—Ç —É–∑–ª—ã AST –∏–ª–∏ —Ç–æ–∫–µ–Ω—ã.
    action_table –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –¥–µ–π—Å—Ç–≤–∏—è (shift/reduce/accept).
    goto_table –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç, –∫—É–¥–∞ –ø–µ—Ä–µ–π—Ç–∏ –ø–æ—Å–ª–µ reduce.
    rules –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç, –∫–∞–∫–∏–µ —Ç–æ–∫–µ–Ω—ã –∑–∞–º–µ–Ω—è—é—Ç—Å—è –Ω–∞ –Ω–µ—Ç–µ—Ä–º–∏–Ω–∞–ª—ã.

–≠—Ç–æ—Ç –º–µ—Ö–∞–Ω–∏–∑–º –ø–æ–∑–≤–æ–ª—è–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Ä–∞–∑–±–∏—Ä–∞—Ç—å –≤—ã—Ä–∞–∂–µ–Ω–∏—è –ø–æ –ø—Ä–∞–≤–∏–ª–∞–º –≥—Ä–∞–º–º–∞—Ç–∏–∫–∏! üöÄ